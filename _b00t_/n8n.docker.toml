[b00t]
name = "n8n"
type = "docker"
desires = "latest"
hint = "n8n - Workflow automation tool for technical teams. Self-hosted alternative to Zapier/Make. Perfect for AI/ML pipeline orchestration, budget-aware scheduling, and complex multi-step jobs."
lfmf_category = "n8n"

# Docker configuration
image = "n8nio/n8n:latest"
docker_args = [
    "-p", "5678:5678",
    "-v", "~/.n8n:/home/node/.n8n",
    "--name", "n8n",
    "--restart", "unless-stopped"
]

# Environment variables required for n8n
[b00t.env]
# Basic auth (recommended for security)
N8N_BASIC_AUTH_ACTIVE = "true"
N8N_BASIC_AUTH_USER = "${N8N_BASIC_AUTH_USER:-admin}"
N8N_BASIC_AUTH_PASSWORD = "${N8N_BASIC_AUTH_PASSWORD}"

# Host configuration
N8N_HOST = "${N8N_HOST:-localhost}"
N8N_PORT = "5678"
N8N_PROTOCOL = "${N8N_PROTOCOL:-http}"

# Webhook URL for external integrations
WEBHOOK_URL = "${WEBHOOK_URL:-http://localhost:5678/}"

# Execution mode
EXECUTIONS_MODE = "${EXECUTIONS_MODE:-regular}"

# Timezone
GENERIC_TIMEZONE = "${GENERIC_TIMEZONE:-America/New_York}"

# Database (optional - defaults to SQLite)
# DB_TYPE = "postgresdb"
# DB_POSTGRESDB_HOST = "localhost"
# DB_POSTGRESDB_PORT = "5432"
# DB_POSTGRESDB_DATABASE = "n8n"
# DB_POSTGRESDB_USER = "n8n"
# DB_POSTGRESDB_PASSWORD = "${DB_POSTGRESDB_PASSWORD}"

[b00t.learn]
topic = "n8n"
auto_digest = false

[[b00t.usage]]
description = "Run n8n with Docker"
command = "docker run -d -p 5678:5678 -v ~/.n8n:/home/node/.n8n --name n8n n8nio/n8n"

[[b00t.usage]]
description = "Access n8n web interface"
command = "open http://localhost:5678"

[[b00t.usage]]
description = "View n8n logs"
command = "docker logs -f n8n"

[[b00t.usage]]
description = "Stop n8n"
command = "docker stop n8n"

[[b00t.usage]]
description = "Start n8n"
command = "docker start n8n"

[[b00t.usage]]
description = "Run n8n with custom env vars"
command = "docker run -d -p 5678:5678 -e N8N_BASIC_AUTH_ACTIVE=true -e N8N_BASIC_AUTH_USER=admin -e N8N_BASIC_AUTH_PASSWORD=secret -v ~/.n8n:/home/node/.n8n --name n8n n8nio/n8n"

# Stack orchestration metadata for AI/ML pipelines
[b00t.orchestration]
# Scheduling constraints
schedule_type = "budget_aware"  # Can be: budget_aware, time_based, resource_based
default_budget = "${DAILY_BUDGET:-100.00}"
budget_currency = "USD"

# Resource requirements for pipeline orchestration
resource_requirements = { cpu = "2", memory = "4Gi", gpu = "optional" }

# Integration points for k8s/k0s
k8s_compatible = true
pod_template_source = "datum_display"  # Use datum display trait for CRD generation
